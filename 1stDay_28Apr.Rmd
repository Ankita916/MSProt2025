---
title: "Introduction to Spectra object in R"
author: "Mohieddin Jafari"
date: "2024-11-18"
output: html_document
---
## Resources
Bioconductor packages tagged by "proteomics":
https://bioconductor.org/packages/release/BiocViews.html#___Proteomics

```{r setup, include=TRUE, echo=TRUE, eval=FALSE}
knitr::opts_chunk$set(echo = FALSE)
## install.package("BiocManager")

#library(BiocManager)

## Bioconductor packages
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("tidyverse")
BiocManager::install("factoextra")
BiocManager::install("msdata")
BiocManager::install("mzR")
BiocManager::install("rhdf5")
BiocManager::install("rpx")
BiocManager::install("MsCoreUtils")
BiocManager::install("QFeatures")
BiocManager::install("Spectra")
BiocManager::install("ProtGenerics")
BiocManager::install("PSMatch")
BiocManager::install("pheatmap")
BiocManager::install("limma")
BiocManager::install("MSnID")
BiocManager::install("RforMassSpectrometry/SpectraVis")

install.packages("tidyverse")
```
Download some data:
```{r, warning=FALSE, message=FALSE}
library(rpx)
px <- PXDataset("PXD000001") ## answer yes if asked to create a cache directory
fn <- "TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzML"
mzf <- pxget(px, fn)
px <- PXDataset("PXD022816")
pxget(px, grep("mzID", pxfiles(px))[1:3])
pxget(px, grep("mzML", pxfiles(px))[1:3])
```

## Review some points about MS data
- The continuous workflow of separating-separating-separating!

- Three dimensions: Retention time of analyser elution - M/Z - Measurement of Intensity

**Spectrum is the unit of mass spectrometry data**


*TIC (total ion chromatogram) plot*: The intensities of all ions in each mass spectrometer scan (within a given time period) are summed and plotted as a function of time.
*Base peak chromatogram plot*: The intensity of the base peak (the most intense ion in each mass spectrum) is plotted as a function of time. (Note: do not confuse the base peak with the baseline, which represents the constant signal from the background level of the instrument.)
*XIC or EIC plot*: The intensity of a specific analyte at a chosen m/z value (either total or base peak intensity) is isolated and plotted as a function of time.
![Alt text for the image](TIC_XIC.png)

## Getting data
Get to know the ProteomeXchange Consortium: Established to create globally coordinated, standardized pipelines for data submission and dissemination across major proteomics repositories, the Consortium promotes open data policies in proteomics.

`proteomexchange.org`

```{r, message=FALSE}
#Direct accessing data
#library("rpx")
px <- PXDataset("PXD000001")
#PXDataset("PXD000294")
px

pxtax(px) # taxonomic name
pxref(px) # bibliography ref

pxfiles(px) # file names of the object
pxfiles(px, as.vector = TRUE) |> print()

pxget(px, "erwinia_carotovora.fasta")
pxget(px, "README.txt") # a vector defining the files to be downloaded

f <- pxget(px, "TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzML")
```

### Quiz 1
Visit `gosocrative.com` and enter room name `jafari9471`